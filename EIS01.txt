e
var f
var r
var i
# Select channel 0.
set_pgstat_chan 0
# High speed mode is
# required for EIS.
set_pgstat_mode 3
# Autorange starting at
# 1 mA down to 10 uA.
set_autoranging ba 10u 1m
# Cell must be on to do
# measurements.
cell_on
# send_string returns any text
# If the first character is a
# lower case p PalmExec returns
# the next 3 characters as
# a process.
# A process can be e.g. used
# to differentiate between two
# of the same measurements with
# different parameters.
send_string "pEI1"
# Run a EIS measurement.
# Amplitude of the sine wave: 10mV
# Start frequency: 200kHz
# End frequency: 200Hz
# Number of frequencies: 11
# DC potential offset: 0V
# Send measurement package
# containing frequency,
# Z-real and Z-imaginary.
meas_loop_eis f r i 10m 200k 200 11 0
    pck_start
    pck_add f
    pck_add r
    pck_add i
    pck_end
endloop
# Turn cell off when finished or
# aborted.
on_finished:
cell_off

